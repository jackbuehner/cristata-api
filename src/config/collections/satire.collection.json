{
  "name": "Satire",
  "canPublish": true,
  "withPermissions": true,
  "withSubscription": true,
  "publicRules": { "filter": { "stage": 5.2 }, "slugDateField": "timestamps.published_at" },
  "schemaDef": {
    "name": { "type": "String", "required": true, "modifiable": true, "public": true, "default": "New Satire" },
    "slug": {
      "type": "String",
      "modifiable": true,
      "public": true,
      "setter": {
        "condition": { "$and": [{ "stage": { "$eq": 5.2 } }, { "slug": { "$exists": false } }] },
        "value": { "slugify": "name" }
      }
    },
    "stage": { "type": "Float", "modifiable": true, "default": 1.1 },
    "tags": { "type": ["String"], "modifiable": true, "public": true, "default": [] },
    "description": { "type": "String", "required": true, "modifiable": true, "public": true, "default": "" },
    "photo_path": { "type": "String", "required": true, "modifiable": true, "public": true, "default": "" },
    "photo_credit": { "type": "String", "required": true, "modifiable": true, "public": true, "default": "" },
    "photo_caption": { "type": "String", "required": true, "modifiable": true, "public": true, "default": "" },
    "body": { "type": "String", "modifiable": true, "public": true },
    "legacy_html": {
      "type": "Boolean",
      "required": true,
      "modifiable": true,
      "public": true,
      "default": false
    },
    "people": {
      "authors": { "type": ["[User]", ["ObjectId"]], "required": true, "modifiable": true, "default": [] },
      "display_authors": {
        "type": ["String"],
        "required": true,
        "modifiable": true,
        "public": true,
        "default": []
      },
      "editors": {
        "primary": { "type": ["[User]", ["ObjectId"]], "required": true, "modifiable": true, "default": [] },
        "copy": { "type": ["[User]", ["ObjectId"]], "required": true, "modifiable": true, "default": [] }
      }
    },
    "timestamps": {
      "target_publish_at": { "type": "Date", "modifiable": true, "default": "0001-01-01T01:00:00.000+00:00" }
    },
    "permissions": {
      "teams": {
        "type": ["ObjectId"],
        "modifiable": true,
        "default": ["000000000000000000000003", "000000000000000000000004"],
        "required": true
      }
    }
  },
  "customQueries": [
    {
      "name": "stageCounts",
      "description": "Get the number of satires in each stage.",
      "returns": "[{ _id: Float!, count: Int! }]",
      "pipeline": [{ "$group": { "_id": "$stage", "count": { "$sum": 1 } } }]
    }
  ],
  "actionAccess": {
    "get": { "teams": [0], "users": [] },
    "create": { "teams": [0], "users": [] },
    "modify": { "teams": [0], "users": [] },
    "hide": { "teams": [0], "users": [] },
    "lock": { "teams": ["admin"], "users": [] },
    "watch": { "teams": [0], "users": [] },
    "publish": { "teams": ["admin"], "users": [] },
    "delete": { "teams": ["admin"], "users": [] },
    "bypassDocPermissions": { "teams": ["managing-editors"], "users": [] }
  }
}
